<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>PayPal Recurring &amp; Direct Payment Script</title>
    <link href="css/styles.css" rel="stylesheet" type="text/css" /> 
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.js"></script>    
</head>

<body>

<div id="wrapper">
    
      <h1>Recurring &amp; Direct PayPal Payment Form</h1>
        
      <form id="form" name="form" method="post" action="">
                
        <div class="field">
            <label>First Name</label>
            <input id="f_nm" type="text" name="f_nm"/>
        </div>
        
        <div class="field">
            <label>Last Name</label>
            <input id="l_nm" type="text" name="l_nm"/>
        </div>
        
        <div class="field">
            <label>Email</label>
            <input id="email" type="text" name="email"/>
        </div>
        
        <div class="field">
            <label>Payment Period</label>
            <select id="period" name="period">
                <option value="3">3 Months</option>
        		<option value="4">4 Months</option>
        		<option value="5">5 Months</option>
        		<option value="6">6 Months</option>
        		<option value="7">7 Months</option>
        		<option value="8">8 Months</option>
        		<option value="9">9 Months</option>
        		<option value="10">10 Months</option>
        		<option value="11">11 Months</option>
        		<option value="12">12 Months</option>
        		<option value="13">13 Months</option>
        		<option value="14">14 Months</option>
      		</select>
        </div>
        
        <div class="field">
            <label>Card Type</label>
            <select id="cardtype" name="cardtype">
                <option value="Visa">Visa</option>
        		<option value="Mastercard">Mastercard</option>
        		<option value="Discover">Discover</option>
        		<option value="Amex">Amex</option>
        	</select>
    	</div>										
    		
        <div class="field">    									
      	    <label>Card Number</label>
            <input id="cardnumber" type="text" name="cardnumber"/>
        </div>
        
        <div class="field">
            <label>Expiration Date</label>
            <select id="cardexpm" name="cardexpm">
        	   <option value="1">1</option>
        	   <option value="2">2</option>
        	   <option value="3">3</option>
        	   <option value="4">4</option>
        	   <option value="5">5</option>
        	   <option value="6">6</option>
        	   <option value="7">7</option>
        	   <option value="8">8</option>
        	   <option value="9">9</option>
        	   <option value="10">10</option>
        	   <option value="11">11</option>
        	   <option value="12">12</option>
        	</select>           
        
           <select id="cardexpy" name="cardexpy">
        	   <option value="2011">2011</option>
        	   <option value="2012">2012</option>
        	   <option value="2013">2013</option>
           </select>
       </div> 
       
       <button type="submit">Submit</button>
    
      </form>
      
      <ul id="errors"></ul>
    
</div>
    
    <script type="text/javascript">
		$("#form").submit(function() {
	      
	    	$("#errors").fadeOut().empty();
          
	        var UserPayInfo = {
				f_nm: $("#f_nm").val(),
		        l_nm: $("#l_nm").val(),
		        email: $("#email").val(),
		        period: $("#period").val(),
		        cardtype: $("#cardtype").val(),
		        cardnumber: $("#cardnumber").val(),
		        cardexpm: $("#cardexpm").val(),
		        cardexpy: $("#cardexpy").val()
			};
          
	        var errors = 0;

			$.each(UserPayInfo, function(key, val) {
				if(val == '') {
					$("#" + key).parent().addClass("error");
					errors++;
				}
			});
          
	        if(errors === 0) {
	        	$.ajax({
	            	type: "POST",
	                dataType: "json",
	                url: "deluxeproc.php",
	                data : "f_nm=" + UserPayInfo.f_nm + "&l_nm=" + UserPayInfo.l_nm + "&email=" + UserPayInfo.email + 
						   "&period=" + UserPayInfo.period + "&cardtype=" + UserPayInfo.cardtype + 
	                       "&cardnumber=" + UserPayInfo.cardnumber + "&cardexpm=" + UserPayInfo.cardexpm + 
	                       "&cardexpy=" + UserPayInfo.cardexpy + "", 
	                success: function(responseJSON) {
	                    //console.log(responseJSON);
	                	$.each(responseJSON, function() {
	                        $("#errors").append("<li>" + this + "</li>");       
	                    });
                    
	                    $("#errors").fadeIn();
	                }                
	        	});
	        }

			return false;
		});
       
		$("input").change(function() {
	    	$(this).parent().removeClass("error");
	    });
    </script>

</body>
</html>